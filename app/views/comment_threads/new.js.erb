console.log("rendering new js erb");
var user = "varun";

var $comment_thread = $("<%= escape_javascript(render 'comment_thread') %>");

$comment_thread
              .on("keypress", "textarea", function(e) {
                var code = e.keyCode? e.keyCode : e.which;
                if (code==13) { 
                  e.preventDefault();
                  var comment         = $(this).val();
                  var comment_history = $(this).parent().find(".comment-history");
                  if (comment.trim()!="") {
                    var new_comment_line = $("<span class=comment>" + user  + ": " + comment + "<br /></span>");
                    comment_history.append(new_comment_line);
                  }
                  $(this).val("").focus();
                }
              })

              .find("textarea").droppable({
                
                over:   function(e, ui) {
                  console.log("over")
                },

                out:    function(e, ui) {
                  console.log("out")
                },
                
                accept: function(e, ui) {
                  console.log("accept")
                },

                drop:   function(e, ui) {
                  console.log("drop")
                },

                snap:       true,
                greedy:     true,
                tolerance:  "pointer"

              })

$("#design-container").append($comment_thread);